MERGE Ods.`OracleEbs-PER_ALL_ASSIGNMENTS_F` AS T using OdsStage.`OracleEbs-PER_ALL_ASSIGNMENTS_F` AS S on 
T.ASSIGNMENT_ID = S.ASSIGNMENT_ID and
T.EFFECTIVE_START_DATE = S.EFFECTIVE_START_DATE and
T.EFFECTIVE_END_DATE = S.EFFECTIVE_END_DATE
 
WHEN MATCHED THEN
Update SET
 T.ParentSystemId = S.ParentSystemId
,T.SystemId = S.SystemId		 
,T.BUSINESS_GROUP_ID   =   S.BUSINESS_GROUP_ID
,T.RECRUITER_ID   =   S.RECRUITER_ID
,T.GRADE_ID   =   S.GRADE_ID
,T.POSITION_ID   =   S.POSITION_ID
,T.JOB_ID   =   S.JOB_ID
,T.ASSIGNMENT_STATUS_TYPE_ID   =   S.ASSIGNMENT_STATUS_TYPE_ID
,T.PAYROLL_ID   =   S.PAYROLL_ID
,T.LOCATION_ID   =   S.LOCATION_ID
,T.PERSON_REFERRED_BY_ID   =   S.PERSON_REFERRED_BY_ID
,T.SUPERVISOR_ID   =   S.SUPERVISOR_ID
,T.SPECIAL_CEILING_STEP_ID   =   S.SPECIAL_CEILING_STEP_ID
,T.PERSON_ID   =   S.PERSON_ID
,T.RECRUITMENT_ACTIVITY_ID   =   S.RECRUITMENT_ACTIVITY_ID
,T.SOURCE_ORGANIZATION_ID   =   S.SOURCE_ORGANIZATION_ID
,T.ORGANIZATION_ID   =   S.ORGANIZATION_ID
,T.PEOPLE_GROUP_ID   =   S.PEOPLE_GROUP_ID
,T.SOFT_CODING_KEYFLEX_ID   =   S.SOFT_CODING_KEYFLEX_ID
,T.VACANCY_ID   =   S.VACANCY_ID
,T.PAY_BASIS_ID   =   S.PAY_BASIS_ID
,T.ASSIGNMENT_SEQUENCE   =   S.ASSIGNMENT_SEQUENCE
,T.ASSIGNMENT_TYPE   =   S.ASSIGNMENT_TYPE
,T.PRIMARY_FLAG   =   S.PRIMARY_FLAG
,T.APPLICATION_ID   =   S.APPLICATION_ID
,T.ASSIGNMENT_NUMBER   =   S.ASSIGNMENT_NUMBER
,T.CHANGE_REASON   =   S.CHANGE_REASON
,T.COMMENT_ID   =   S.COMMENT_ID
,T.DATE_PROBATION_END   =   S.DATE_PROBATION_END
,T.DEFAULT_CODE_COMB_ID   =   S.DEFAULT_CODE_COMB_ID
,T.EMPLOYMENT_CATEGORY   =   S.EMPLOYMENT_CATEGORY
,T.FREQUENCY   =   S.FREQUENCY
,T.INTERNAL_ADDRESS_LINE   =   S.INTERNAL_ADDRESS_LINE
,T.MANAGER_FLAG   =   S.MANAGER_FLAG
,T.NORMAL_HOURS   =   S.NORMAL_HOURS
,T.PERF_REVIEW_PERIOD   =   S.PERF_REVIEW_PERIOD
,T.PERF_REVIEW_PERIOD_FREQUENCY   =   S.PERF_REVIEW_PERIOD_FREQUENCY
,T.PERIOD_OF_SERVICE_ID   =   S.PERIOD_OF_SERVICE_ID
,T.PROBATION_PERIOD   =   S.PROBATION_PERIOD
,T.PROBATION_UNIT   =   S.PROBATION_UNIT
,T.SAL_REVIEW_PERIOD   =   S.SAL_REVIEW_PERIOD
,T.SAL_REVIEW_PERIOD_FREQUENCY   =   S.SAL_REVIEW_PERIOD_FREQUENCY
,T.SET_OF_BOOKS_ID   =   S.SET_OF_BOOKS_ID
,T.SOURCE_TYPE   =   S.SOURCE_TYPE
,T.TIME_NORMAL_FINISH   =   S.TIME_NORMAL_FINISH
,T.TIME_NORMAL_START   =   S.TIME_NORMAL_START
,T.REQUEST_ID   =   S.REQUEST_ID
,T.PROGRAM_APPLICATION_ID   =   S.PROGRAM_APPLICATION_ID
,T.PROGRAM_ID   =   S.PROGRAM_ID
,T.PROGRAM_UPDATE_DATE   =   S.PROGRAM_UPDATE_DATE
,T.ASS_ATTRIBUTE_CATEGORY   =   S.ASS_ATTRIBUTE_CATEGORY
,T.ASS_ATTRIBUTE1   =   S.ASS_ATTRIBUTE1
,T.ASS_ATTRIBUTE2   =   S.ASS_ATTRIBUTE2
,T.ASS_ATTRIBUTE3   =   S.ASS_ATTRIBUTE3
,T.ASS_ATTRIBUTE4   =   S.ASS_ATTRIBUTE4
,T.ASS_ATTRIBUTE5   =   S.ASS_ATTRIBUTE5
,T.ASS_ATTRIBUTE6   =   S.ASS_ATTRIBUTE6
,T.ASS_ATTRIBUTE7   =   S.ASS_ATTRIBUTE7
,T.ASS_ATTRIBUTE8   =   S.ASS_ATTRIBUTE8
,T.ASS_ATTRIBUTE9   =   S.ASS_ATTRIBUTE9
,T.ASS_ATTRIBUTE10   =   S.ASS_ATTRIBUTE10
,T.ASS_ATTRIBUTE11   =   S.ASS_ATTRIBUTE11
,T.ASS_ATTRIBUTE12   =   S.ASS_ATTRIBUTE12
,T.ASS_ATTRIBUTE13   =   S.ASS_ATTRIBUTE13
,T.ASS_ATTRIBUTE14   =   S.ASS_ATTRIBUTE14
,T.ASS_ATTRIBUTE15   =   S.ASS_ATTRIBUTE15
,T.ASS_ATTRIBUTE16   =   S.ASS_ATTRIBUTE16
,T.ASS_ATTRIBUTE17   =   S.ASS_ATTRIBUTE17
,T.ASS_ATTRIBUTE18   =   S.ASS_ATTRIBUTE18
,T.ASS_ATTRIBUTE19   =   S.ASS_ATTRIBUTE19
,T.ASS_ATTRIBUTE20   =   S.ASS_ATTRIBUTE20
,T.ASS_ATTRIBUTE21   =   S.ASS_ATTRIBUTE21
,T.ASS_ATTRIBUTE22   =   S.ASS_ATTRIBUTE22
,T.ASS_ATTRIBUTE23   =   S.ASS_ATTRIBUTE23
,T.ASS_ATTRIBUTE24   =   S.ASS_ATTRIBUTE24
,T.ASS_ATTRIBUTE25   =   S.ASS_ATTRIBUTE25
,T.ASS_ATTRIBUTE26   =   S.ASS_ATTRIBUTE26
,T.ASS_ATTRIBUTE27   =   S.ASS_ATTRIBUTE27
,T.ASS_ATTRIBUTE28   =   S.ASS_ATTRIBUTE28
,T.ASS_ATTRIBUTE29   =   S.ASS_ATTRIBUTE29
,T.ASS_ATTRIBUTE30   =   S.ASS_ATTRIBUTE30
,T.LAST_UPDATE_DATE   =   S.LAST_UPDATE_DATE
,T.LAST_UPDATED_BY   =   S.LAST_UPDATED_BY
,T.LAST_UPDATE_LOGIN   =   S.LAST_UPDATE_LOGIN
,T.CREATED_BY   =   S.CREATED_BY
,T.CREATION_DATE   =   S.CREATION_DATE
,T.TITLE   =   S.TITLE
,T.OBJECT_VERSION_NUMBER   =   S.OBJECT_VERSION_NUMBER
,T.BARGAINING_UNIT_CODE   =   S.BARGAINING_UNIT_CODE
,T.LABOUR_UNION_MEMBER_FLAG   =   S.LABOUR_UNION_MEMBER_FLAG
,T.HOURLY_SALARIED_CODE   =   S.HOURLY_SALARIED_CODE
,T.CONTRACT_ID   =   S.CONTRACT_ID
,T.COLLECTIVE_AGREEMENT_ID   =   S.COLLECTIVE_AGREEMENT_ID
,T.CAGR_ID_FLEX_NUM   =   S.CAGR_ID_FLEX_NUM
,T.CAGR_GRADE_DEF_ID   =   S.CAGR_GRADE_DEF_ID
,T.ESTABLISHMENT_ID   =   S.ESTABLISHMENT_ID
,T.APPLICANT_RANK   =   S.APPLICANT_RANK
,T.NOTICE_PERIOD   =   S.NOTICE_PERIOD
,T.NOTICE_PERIOD_UOM   =   S.NOTICE_PERIOD_UOM
,T.EMPLOYEE_CATEGORY   =   S.EMPLOYEE_CATEGORY
,T.WORK_AT_HOME   =   S.WORK_AT_HOME
,T.JOB_POST_SOURCE_NAME   =   S.JOB_POST_SOURCE_NAME
,T.POSTING_CONTENT_ID   =   S.POSTING_CONTENT_ID
,T.PERIOD_OF_PLACEMENT_DATE_START   =   S.PERIOD_OF_PLACEMENT_DATE_START
,T.VENDOR_ID   =   S.VENDOR_ID
,T.VENDOR_EMPLOYEE_NUMBER   =   S.VENDOR_EMPLOYEE_NUMBER
,T.VENDOR_ASSIGNMENT_NUMBER   =   S.VENDOR_ASSIGNMENT_NUMBER
,T.ASSIGNMENT_CATEGORY   =   S.ASSIGNMENT_CATEGORY
,T.PROJECT_TITLE   =   S.PROJECT_TITLE
,T.GRADE_LADDER_PGM_ID   =   S.GRADE_LADDER_PGM_ID
,T.SUPERVISOR_ASSIGNMENT_ID   =   S.SUPERVISOR_ASSIGNMENT_ID
,T.VENDOR_SITE_ID   =   S.VENDOR_SITE_ID
,T.PO_HEADER_ID   =   S.PO_HEADER_ID
,T.PO_LINE_ID   =   S.PO_LINE_ID
,T.PROJECTED_ASSIGNMENT_END   =   S.PROJECTED_ASSIGNMENT_END
,T.LoadBy = 'airflow-worker'
,T.LoadDate = CURRENT_TIMESTAMP
,T.LoadProcess = 'Dag - Corp_OracleEbs_BigQuery_PER_ALL_ASSIGNMENTS_F_Import'
,T.CreateBy = 'airflow-worker'
,T.CreateDate = CURRENT_TIMESTAMP
,T.CreateProcess = 'Dag - Corp_OracleEbs_BigQuery_PER_ALL_ASSIGNMENTS_F_Import'
,T.UpdateBy = 'airflow-worker'
,T.UpdateDate = CURRENT_TIMESTAMP
,T.UpdateProcess = 'Dag - Corp_OracleEbs_BigQuery_PER_ALL_ASSIGNMENTS_F_Import'
,T.InactiveInd = False
,T.InactiveReason = ''

	WHEN NOT MATCHED THEN

INSERT (
ParentSystemId,	SystemId,	ASSIGNMENT_ID,	EFFECTIVE_START_DATE,	EFFECTIVE_END_DATE,	BUSINESS_GROUP_ID,	RECRUITER_ID,	GRADE_ID,	POSITION_ID,	JOB_ID,	ASSIGNMENT_STATUS_TYPE_ID,	PAYROLL_ID,	LOCATION_ID,	PERSON_REFERRED_BY_ID,	SUPERVISOR_ID,	SPECIAL_CEILING_STEP_ID,	PERSON_ID,	RECRUITMENT_ACTIVITY_ID,	SOURCE_ORGANIZATION_ID,	ORGANIZATION_ID,	PEOPLE_GROUP_ID,	SOFT_CODING_KEYFLEX_ID,	VACANCY_ID,	PAY_BASIS_ID,	ASSIGNMENT_SEQUENCE,	ASSIGNMENT_TYPE,	PRIMARY_FLAG,	APPLICATION_ID,	ASSIGNMENT_NUMBER,	CHANGE_REASON,	COMMENT_ID,	DATE_PROBATION_END,	DEFAULT_CODE_COMB_ID,	EMPLOYMENT_CATEGORY,	FREQUENCY,	INTERNAL_ADDRESS_LINE,	MANAGER_FLAG,	NORMAL_HOURS,	PERF_REVIEW_PERIOD,	PERF_REVIEW_PERIOD_FREQUENCY,	PERIOD_OF_SERVICE_ID,	PROBATION_PERIOD,	PROBATION_UNIT,	SAL_REVIEW_PERIOD,	SAL_REVIEW_PERIOD_FREQUENCY,	SET_OF_BOOKS_ID,	SOURCE_TYPE,	TIME_NORMAL_FINISH,	TIME_NORMAL_START,	REQUEST_ID,	PROGRAM_APPLICATION_ID,	PROGRAM_ID,	PROGRAM_UPDATE_DATE,ASS_ATTRIBUTE_CATEGORY,	ASS_ATTRIBUTE1,	ASS_ATTRIBUTE2,	ASS_ATTRIBUTE3,	ASS_ATTRIBUTE4,	ASS_ATTRIBUTE5,	ASS_ATTRIBUTE6,	ASS_ATTRIBUTE7,	ASS_ATTRIBUTE8,	ASS_ATTRIBUTE9,	ASS_ATTRIBUTE10,	ASS_ATTRIBUTE11,	ASS_ATTRIBUTE12,	ASS_ATTRIBUTE13,	ASS_ATTRIBUTE14,	ASS_ATTRIBUTE15,	ASS_ATTRIBUTE16,	ASS_ATTRIBUTE17,	ASS_ATTRIBUTE18,ASS_ATTRIBUTE19,	ASS_ATTRIBUTE20,	ASS_ATTRIBUTE21,	ASS_ATTRIBUTE22,	ASS_ATTRIBUTE23,	ASS_ATTRIBUTE24,	ASS_ATTRIBUTE25,	ASS_ATTRIBUTE26,	ASS_ATTRIBUTE27,ASS_ATTRIBUTE28,	ASS_ATTRIBUTE29,	ASS_ATTRIBUTE30,	LAST_UPDATE_DATE,	LAST_UPDATED_BY,	LAST_UPDATE_LOGIN,	CREATED_BY,	CREATION_DATE,	TITLE,	OBJECT_VERSION_NUMBER,BARGAINING_UNIT_CODE,	LABOUR_UNION_MEMBER_FLAG,	HOURLY_SALARIED_CODE,	CONTRACT_ID,	COLLECTIVE_AGREEMENT_ID,	CAGR_ID_FLEX_NUM,	CAGR_GRADE_DEF_ID,	ESTABLISHMENT_ID,	APPLICANT_RANK,	NOTICE_PERIOD,	NOTICE_PERIOD_UOM,	EMPLOYEE_CATEGORY,	WORK_AT_HOME,	JOB_POST_SOURCE_NAME,	POSTING_CONTENT_ID,	PERIOD_OF_PLACEMENT_DATE_START,	VENDOR_ID,	VENDOR_EMPLOYEE_NUMBER,	VENDOR_ASSIGNMENT_NUMBER,	ASSIGNMENT_CATEGORY,	PROJECT_TITLE,	GRADE_LADDER_PGM_ID,	SUPERVISOR_ASSIGNMENT_ID,	VENDOR_SITE_ID,	PO_HEADER_ID,	PO_LINE_ID,	PROJECTED_ASSIGNMENT_END,	LoadBy,	LoadDate,	LoadProcess,	CreateBy,	CreateDate,	CreateProcess,	UpdateBy,	UpdateDate,	UpdateProcess,	InactiveInd,	InactiveReason )
VALUES (
ParentSystemId,	SystemId,	ASSIGNMENT_ID,	EFFECTIVE_START_DATE,	EFFECTIVE_END_DATE,	BUSINESS_GROUP_ID,	RECRUITER_ID,	GRADE_ID,	POSITION_ID,	JOB_ID,	ASSIGNMENT_STATUS_TYPE_ID,	PAYROLL_ID,	LOCATION_ID,	PERSON_REFERRED_BY_ID,	SUPERVISOR_ID,	SPECIAL_CEILING_STEP_ID,	PERSON_ID,	RECRUITMENT_ACTIVITY_ID,	SOURCE_ORGANIZATION_ID,	ORGANIZATION_ID,	PEOPLE_GROUP_ID,	SOFT_CODING_KEYFLEX_ID,	VACANCY_ID,	PAY_BASIS_ID,	ASSIGNMENT_SEQUENCE,	ASSIGNMENT_TYPE,	PRIMARY_FLAG,	APPLICATION_ID,	ASSIGNMENT_NUMBER,	CHANGE_REASON,	COMMENT_ID,	DATE_PROBATION_END,	DEFAULT_CODE_COMB_ID,	EMPLOYMENT_CATEGORY,	FREQUENCY,	INTERNAL_ADDRESS_LINE,	MANAGER_FLAG,	NORMAL_HOURS,	PERF_REVIEW_PERIOD,	PERF_REVIEW_PERIOD_FREQUENCY,	PERIOD_OF_SERVICE_ID,	PROBATION_PERIOD,	PROBATION_UNIT,	SAL_REVIEW_PERIOD,	SAL_REVIEW_PERIOD_FREQUENCY,	SET_OF_BOOKS_ID,	SOURCE_TYPE,	TIME_NORMAL_FINISH,	TIME_NORMAL_START,	REQUEST_ID,	PROGRAM_APPLICATION_ID,	PROGRAM_ID,	PROGRAM_UPDATE_DATE,ASS_ATTRIBUTE_CATEGORY,	ASS_ATTRIBUTE1,	ASS_ATTRIBUTE2,	ASS_ATTRIBUTE3,	ASS_ATTRIBUTE4,	ASS_ATTRIBUTE5,	ASS_ATTRIBUTE6,	ASS_ATTRIBUTE7,	ASS_ATTRIBUTE8,	ASS_ATTRIBUTE9,	ASS_ATTRIBUTE10,	ASS_ATTRIBUTE11,	ASS_ATTRIBUTE12,	ASS_ATTRIBUTE13,	ASS_ATTRIBUTE14,	ASS_ATTRIBUTE15,	ASS_ATTRIBUTE16,	ASS_ATTRIBUTE17,	ASS_ATTRIBUTE18,ASS_ATTRIBUTE19,	ASS_ATTRIBUTE20,	ASS_ATTRIBUTE21,	ASS_ATTRIBUTE22,	ASS_ATTRIBUTE23,	ASS_ATTRIBUTE24,	ASS_ATTRIBUTE25,	ASS_ATTRIBUTE26,	ASS_ATTRIBUTE27,ASS_ATTRIBUTE28,	ASS_ATTRIBUTE29,	ASS_ATTRIBUTE30,	LAST_UPDATE_DATE,	LAST_UPDATED_BY,	LAST_UPDATE_LOGIN,	CREATED_BY,	CREATION_DATE,	TITLE,	OBJECT_VERSION_NUMBER,BARGAINING_UNIT_CODE,	LABOUR_UNION_MEMBER_FLAG,	HOURLY_SALARIED_CODE,	CONTRACT_ID,	COLLECTIVE_AGREEMENT_ID,	CAGR_ID_FLEX_NUM,	CAGR_GRADE_DEF_ID,	ESTABLISHMENT_ID,	APPLICANT_RANK,	NOTICE_PERIOD,	NOTICE_PERIOD_UOM,	EMPLOYEE_CATEGORY,	WORK_AT_HOME,	JOB_POST_SOURCE_NAME,	POSTING_CONTENT_ID,	PERIOD_OF_PLACEMENT_DATE_START,	VENDOR_ID,	VENDOR_EMPLOYEE_NUMBER,	VENDOR_ASSIGNMENT_NUMBER,	ASSIGNMENT_CATEGORY,	PROJECT_TITLE,	GRADE_LADDER_PGM_ID,	SUPERVISOR_ASSIGNMENT_ID,	VENDOR_SITE_ID,	PO_HEADER_ID,	PO_LINE_ID,	PROJECTED_ASSIGNMENT_END,'airflow-worker',CURRENT_TIMESTAMP,'Dag - Corp_OracleEbs_BigQuery_PER_ALL_ASSIGNMENTS_F_Import','airflow-worker',CURRENT_TIMESTAMP,'Dag - Corp_OracleEbs_BigQuery_PER_ALL_ASSIGNMENTS_F_Import','airflow-worker',CURRENT_TIMESTAMP,'Dag - Corp_OracleEbs_BigQuery_PER_ALL_ASSIGNMENTS_F_Import',False,'')
